services:
  everything:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: everything-search
    ports:
      #
      # Docker ports are defined in the format "HOST:CONTAINER".
      - "5800:5800"    # VNC port (host 5800 -> container 5800)
      - "5900:5900"    # Alternative VNC port (host 5900 -> container 5900)
      - "14680:14680"  # Everything HTTP Server (host 14680 -> container 14680)
      - "14620:14620"  # Everything ETP Server (host 14620 -> container 14620)
      - "14630:14630"  # Everything Server (host 14630 -> container 14630)
    environment:
      - DISPLAY=:0
      - TZ=Europe/Berlin
      - WINEDEBUG=-fixme-all
      - EVERYTHING_BINARY=${EVERYTHING_BINARY:-everything-1.5_x64.exe}
    volumes:
      - ./.data:/opt/everything         # Everything.ini, Everything.db, Everything.exe, and plugins/
    restart: "on-failure:2"
    mem_limit: 2048M
    # mem_reservation: 512M